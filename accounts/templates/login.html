<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>login</title>
    <style>
        .container {
            margin: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
        }
        input {
            width: 200px;
            margin-bottom: 10px;
        }
        button {
            padding: 5px 10px;
            background-color: #007bff;
            color: #fff;
            border: none;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container">
        <label>username:</label><input id="username" type="id" placeholder="id를 입력해주세요." required><br>
        <label>password:</label><input id="password" type="password" placeholder="password 입력해주세요." required><br>
        <button id="button" type="submit">제출</button>
    </div>

    <script>
        const username = document.querySelector("#username");
        const password = document.querySelector("#password");

        const loginbutton = document.querySelector("#button");

        // loginbutton에 클릭 이벤트 리스너를 추가하여 버튼 클릭 시 login() 함수가 호출되도록 한다.
        loginbutton.addEventListener("click", login);

        // login() 함수
        function login() {
            // request 객체 생성 (username, password)
            const request = {
                username : username.value,
                password : password.value,
            }
            // 아무런 값이 입력되지 않았을 때
            if (!username.value || !password.value) {
                console.log("사용자명과 비밀번호를 모두 입력해주세요.");
                return;
            }
            // fetch() 함수를 사용하여 지정된 url로 POST 요청을 보냄
            fetch("http://127.0.0.1:8000/accounts/login/", {
                withCredentials: true, // cookie값 전달
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(request) // body에 request객체를 json형식으로 변환하여 보냄
            })
            .then(response => {
                if (response.ok) {
                    // 응답이 성공적으로 받아졌을 경우 처리
                    console.log("로그인 성공");
                    // 추가적인 동작 수행
                } else {
                    // 응답이 실패했을 경우 처리
                    console.log("로그인 실패");
                    // 추가적인 동작 수행
                }
            })
            .catch(error => {
                // 네트워크 오류 등 예외 처리
                console.log("오류 발생:", error);
            });
        }
    </script>
</body>
</html>
